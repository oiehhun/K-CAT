{"version":3,"file":"transformer.js","sourceRoot":"","sources":["../../../src/storage/transformer.ts"],"names":[],"mappings":";;;AACA,mCAAmC;AAiBtB,QAAA,4BAA4B,GAAoC;IAC5E,qBAAqB,CAAC,IAAI,EAAE,IAAI;QAC/B,MAAM,IAAI,GAAc;YACvB,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,QAAQ,EAAE,IAAI,CAAC,OAAO;SACtB,CAAC;QACF,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IACtC,CAAC;IACD,mBAAmB,CAAC,GAAG;QACtB,MAAM,KAAK,GAAG,IAAA,kBAAS,EAAC,GAAG,CAAQ,CAAC;QACpC,OAAO,KAAK,CAAC,EAAE,CAAC;QAEhB,OAAO;YACN,EAAE,EAAG,GAAW,CAAC,IAAI,CAAC,IAAI,SAAS;YACnC,IAAI,EAAE,KAAK;SACX,CAAC;IACH,CAAC;CACD,CAAC","sourcesContent":["import { ModelMeta } from './model';\nimport { cloneDeep } from 'lodash';\nimport { BaseModel, ModelDataOnly, ModelDataWithId, PatchUpdate } from './types';\n\nexport interface IDocumentTransformer<T extends BaseModel> {\n\tfromFirestoreToObject(data: ModelDataOnly<T>, meta: ModelMeta<true>): T;\n\n\ttoFirestoreDocument(doc: T): { id: string; data: ModelDataOnly<T> };\n\ttoFirestoreDocument(doc: ModelDataOnly<T> | PatchUpdate<ModelDataWithId<T>>): {\n\t\tid: undefined;\n\t\tdata: ModelDataOnly<T>;\n\t};\n\ttoFirestoreDocument(doc: T | ModelDataOnly<T> | PatchUpdate<ModelDataWithId<T>>): {\n\t\tid?: string;\n\t\tdata: ModelDataOnly<T>;\n\t};\n}\n\nexport const DEFAULT_DOCUMENT_TRANSFORMER: IDocumentTransformer<BaseModel> = {\n\tfromFirestoreToObject(data, meta) {\n\t\tconst base: BaseModel = {\n\t\t\tid: meta.id,\n\t\t\t_rawPath: meta.rawPath,\n\t\t};\n\t\treturn Object.assign({}, data, base);\n\t},\n\ttoFirestoreDocument(doc) {\n\t\tconst clone = cloneDeep(doc) as any;\n\t\tdelete clone.id;\n\n\t\treturn {\n\t\t\tid: (doc as any)['id'] || undefined,\n\t\t\tdata: clone,\n\t\t};\n\t},\n};\n"]}